# Test Plan — Current (local + file-based sync)

## Smoke (обязательно перед релизом)
- `flutter analyze`
- `flutter test`

## Unit/Widget tests (минимум)
- Импорт/хранилище: копирование, дедуп по хэшу, удаление книги удаляет файлы.
- Reader: открытие книги, TOC/главы, восстановление позиции.
- Sync adapters: базовые сценарии upload/download для провайдеров (моки).

## Manual сценарии (регресс)
### 1) Import → Read
1. Импортировать `.epub` (и `.fb2/.zip`, если поддерживаются в сборке).
2. Открыть книгу, перейти по TOC, закрыть/открыть — позиция восстановлена.

### 2) Notes/Highlights/Bookmarks
1. Создать highlight + note, перейти к месту из списка заметок.
2. Проверить in-book search (если включён).

### 3) Sync (file-based)
1. Выбрать провайдер синка (Dropbox / Yandex Disk / WebDAV).
2. Подключиться (OAuth или базовые креды).
3. Нажать “Синхронизировать сейчас” → без ошибок; `event_log.json/state.json/books_index.json/meta.json` появляются в облаке.
4. Перезапустить приложение → “последняя синхронизация” сохранена, автосинк не падает.

### 4) Diagnostics
1. Открыть лог-файл (если доступно из UI) или проверить путь в логах.
2. Убедиться, что токены/пароли не попадают в логи.
