# Release plan — Stage 1 (file-based sync) — Draft

Цель: довести server-less file-based sync до “пользовательского качества” без добавления новых провайдеров.

## Scope
- Провайдеры: Dropbox, Yandex Disk, WebDAV/SMB (как fallback для NAS).
- Протокол: `event_log.json`, `state.json`, `meta.json`, `books_index.json`.
- Merge: LWW по `updatedAt` (см. `docs/conflict_policy.md`).

## Release checklist (P0)
- UI: понятный статус синхронизации (последний успех/ошибка), кнопки “Повторить” и “Переподключить”.
- UX: дружелюбное подключение (без требований к пользователю про OAuth keys).
- Надёжность: таймауты разделены на request/transfer, лимит параллелизма на загрузки, retry/backoff на сетевые ошибки.
- Безопасность логов: токены/пароли/Basic auth не пишутся в лог.
- Диагностика: путь к логу виден пользователю + экспорт лога (или “копировать путь”).

## Nice-to-have (P1)
- (Отложено) Опциональное client-side шифрование sync-файлов (пароль/ключ на устройстве).
- Миграция путей/форматов (legacy paths) без ручных действий: чтение legacy путей + запись в новый путь (без ручных переносов).

## Acceptance criteria
- Fresh install + подключение любого из провайдеров → первая синхронизация проходит без крашей.
- При отсутствии файлов в облаке (`404`) приложение не показывает ошибок пользователю (использует пустые данные).
- Загрузка нескольких книг в облако проходит без таймаутов на обычном соединении (порог: 2–5 минут).
- При сетевой ошибке автосинк отключается/показывает понятное сообщение и предлагает восстановление.
