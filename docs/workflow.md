# Соглашение по веткам и PR

## Ветки
- `main` — основная ветка (trunk), только через PR, соответствует прод/релизам.
- `feature/<short-name>` — новая функциональность.
- `bugfix/<short-name>` — исправление дефекта в текущей разработке.
- `hotfix/<short-name>` — срочное исправление для `main`.
- `release/<version>` — подготовка релиза при необходимости (сборка, финальные правки).

## Правила именования
- Используем латиницу, нижний регистр, слова разделяем `-`.
- Короткие, описательные имена: `feature/offline-sync`, `bugfix/import-crash`.
- При наличии трекера задач допускается префикс с номером: `feature/123-reader-cache`.

## Политика работы
- В `main` запрещены прямые пуши.
- Любые изменения — через PR из тематической ветки.
- Одна задача — один PR (без смешивания несвязанных правок).

## Требования к PR
- Краткий заголовок и описание: что сделано, зачем, как проверить.
- Ссылка на задачу/issue, если есть.
- CI должен проходить полностью.
- Команды CI воспроизводимы локально (минимум: `flutter pub get`, `flutter analyze`, `flutter test`).
- Добавлены/обновлены тесты, если меняется логика.
- Документация обновлена, если меняется поведение/интерфейс.

## Правила исключений анализатора
- Используем минимально возможную область исключения (`// ignore:` предпочтительнее `// ignore_for_file:`).
- Каждое исключение сопровождаем краткой причиной и ссылкой на задачу/issue.
- Запрещены глобальные отключения правил в `analysis_options.yaml` без согласования в PR.
- Исключения разрешены только как временная мера и должны быть удалены после исправления причины.

## Процесс ревью
- Минимум 1 аппрув.
- Автор не мержит свой PR без аппрува.
- Замечания фиксируются в том же PR.

## Мердж и обновление веток
- Предпочтение: squash-merge для `feature/` и `bugfix/`.
- Для `release/` и `hotfix/` допускается merge commit.
- Перед мержем обновляем ветку: `git pull --rebase origin main`.

## Релизный поток
- `release/<version>` создается из `main`.
- В `release/` только багфиксы, правки версии и релизные заметки.
- После релиза: мердж в `main` и тегирование версии.
