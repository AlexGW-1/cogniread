# Дизайн приложения CogniRead

Цель — единый визуальный язык для **интеллектуальной читалки + заметок + AI + базы знаний**, с фокусом на чтении и контекстных действиях.

---

## 1) Информационная архитектура и навигация

### Mobile (телефон)

**Bottom nav (5 вкладок):**
1. Библиотека  
2. Поиск  
3. Читалка (последняя открытая книга)  
4. Заметки  
5. Профиль/Настройки

Логика: чтение и заметки — самые частые действия; граф и инсайты доступнее из контекста книги/поиска.

### Tablet / Desktop (iPad / macOS / Windows)

**NavigationRail слева + Split view:**
- слева: список книг / оглавление / поиск  
- справа: Reader  
- дополнительная панель справа: AI / заметка / карточка концепта (по фазам)

---

## 2) Экранный набор по фазам

### MVP (Phase 1)
- Онбординг/вход (опционально)
- Библиотека + импорт
- Карточка книги
- Читалка (оглавление/поиск по книге/настройки текста)
- Выделения и заметки (минимально)
- AI: “Summary главы/фрагмента” + “Объясни выделенное”

### Дальше (Phase 2–4)
- Синхронизация/конфликты
- Глобальный семантический поиск (книги/цитаты/заметки)
- Knowledge Graph (граф + концепты + связи)
- Рекомендации/путь знаний/аналитика чтения

---

## 3) Ключевые экраны

### A. Онбординг
**Цель:** быстро довести до импорта и первого чтения.  
**Блоки:** value-превью, пермишены (файлы/хранилище), вход/пропуск.

---

### B. Библиотека
**Top bar:** поиск, фильтр, сортировка, “+ Импорт”.  
**Контент:** grid (обложки) или list (компактно).  
**Карточка книги:** обложка, прогресс, “Продолжить”, “…” меню.

**Меню книги (…):**
- Открыть  
- Экспорт заметок  
- Пересчитать AI-артефакты (позже)  
- Удалить/архивировать

**Empty state:** “Импортируйте EPUB/PDF” + drag&drop для desktop.

---

### C. Карточка книги (Book Details)
**Hero:** обложка + название/автор + прогресс.  
**Вкладки:** Содержание / Заметки / Инсайты.  
**Primary CTA:** “Продолжить чтение”.

---

### D. Читалка
**Принцип:** текст — главный. UI появляется по тапу/выделению.

**Верхний бар:** название, оглавление, поиск, настройки текста, AI, закладка.  
**Нижняя панель:**
- без выделения: “Заметка”, “Цитата”, “Summary главы”
- с выделением: “Подчеркнуть”, “Заметка”, “Объясни”, “В карточки знаний”

**Оглавление:** drawer/sheet, текущая глава подсвечена.  
**AI‑панель:** вкладки Summary / Объяснение / Вопросы / Связи.

---

### E. Быстрая заметка
**Состав:** заголовок (опц.), текст, теги, привязка, “Сохранить/Отмена”.  
**Важно:** локальное сохранение мгновенно, синк позже.

---

### F. Заметки
**Фильтры:** книга, теги, тип, дата.  
**Карточка:** цитата + заметка + теги + переход к месту в книге.

---

### G. Поиск (глобальный)
Результаты табами: Книги / Цитаты / Заметки / Концепты.  
Переключатель: обычный / семантический поиск (позже).

---

### H. Knowledge Graph (после MVP)
**Graph Overview:** граф (пан/зум), фильтры, тап по узлу → карточка концепта.  
**Concept Detail:** определение, связи, где встречается, ваши заметки.

---

### I. Синхронизация и конфликты (Phase 2)
**Sync status:** статус, список операций, “повторить”.  
**Conflict resolver:** 2 версии заметки + выбор “мою/их/объединить”.

---

### J. Настройки
Разделы: чтение, AI, хранилище, аккаунт/синк, экспорт/бэкап, диагностика.

---

## 4) Дизайн‑система (минимум)
- Material 3 + адаптивные цвета
- Обязателен Dark mode (позже)
- Типографика: Title / Body / Caption; для Reader — отдельная “Reading theme”
- Компоненты:
  - AdaptiveScaffold (NavBar ↔ NavRail)
  - ReaderToolbar, ReaderSelectionMenu
  - AiPanel (sheet/side)
  - NoteCard, QuoteCard, ConceptChip
- Состояния: loading / empty / error / offline badge

---

## 5) Главные UX‑правила
1. Текст — главный, всё остальное появляется по тапу/выделению.
2. Контекстные действия рядом с выделением.
3. AI не блокирует чтение: генерация в фоне, кеширование.
4. Переходы обратимы: “вернуться к месту” из любой заметки/концепта.

---

## 6) Desktop‑настройка (реализуем сейчас)
- Split view: библиотека слева, читалка справа.
- NavigationRail для ключевых разделов.
- Читаемый контент в карточке с ограниченной шириной, мягкими тенями.
- Акцентные кнопки для импорта и TOC.

---

## 7) Архитектура экранов и контроллеров

См. `docs/architecture_ui.md` для экранной карты, потоков и таблицы компонентов/контроллеров.

---

## TL;DR: UI States

- **Loading**: skeleton вместо спиннера; при кешe — stale UI + небольшой индикатор.
- **Empty**: объяснение + 1–2 CTA + подсказка как заполнить.
- **Error**: ErrorBanner + “Повторить”; для рендера книги — отдельный экран с действиями.
- **Offline/Syncing**: ненавязчивый badge + “очередь/последняя попытка”.

Подробно: `docs/ui_states_and_entities.md`.
